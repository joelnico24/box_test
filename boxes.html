<!DOCTYPE html>
<html>
<head>
	<title>circles</title>
	<style type="text/css">
		canvas {
			border: solid 1px black;
		}
	</style>
</head>
<body>
<canvas id="canvas" width="1250" height="655"></canvas>

<script type="text/javascript">
	var canvas = document.getElementById("canvas");
	var context = canvas.getContext("2d");

	var colors = ["red","green","blue","black"];
	var circles = [];

	var gameSettings = {
		maxSize: 40,
		maxDuration: 300,
		numberOfCircles: 100,
		maxSpeed: 5
	}

	function randomNum(n) {
		return Math.floor(Math.random() * n);
	}

	function createCircle() {
		return {
			x: randomNum(canvas.width - gameSettings.maxSize),
			y: randomNum(canvas.height - gameSettings.maxSize),
			size: randomNum(gameSettings.maxSize) + 10,
			color: colors[randomNum(colors.length)],
			duration: randomNum(gameSettings.maxDuration) + 10,
			speed: randomNum(gameSettings.maxSpeed) + 1,
			driftDirection: randomNum(4)
		}
	}

	function createCircles(n) {
		for (i = 0; i < n; i++) {
			circles.push(createCircle());
		}
	}

	function drawCircles() {
		for (i = 0; i < circles.length; i++) {
			context.beginPath();
			context.fillStyle = circles[i].color;
			context.arc(circles[i].x,circles[i].y,circles[i].size,0,2 * Math.PI);
			context.fill();
			context.stroke();

			if (circles[i].driftDirection == 0) {
				circles[i].x += circles[i].speed;
			} else if (circles[i].driftDirection == 1) {
				circles[i].x -= circles[i].speed;
			} else if (circles[i].driftDirection == 2) {
				circles[i].y += circles[i].speed;
			} else if (circles[i].driftDirection == 3) {
				circles[i].y -= circles[i].speed;
			}
		}
	}

	function reduceDuration() {
		for (i = 0; i < circles.length; i++) {
			circles[i].duration--;
			if (circles[i].duration <= 0) {
				circles[i] = createCircle();
			}
		}
	}

	function runGame() {
		context.clearRect(0,0,canvas.width,canvas.height);
		drawCircles();
		reduceDuration();
		requestAnimationFrame(runGame);
	}

	createCircles(gameSettings.numberOfCircles);
	runGame();
</script>
</body>
</html>